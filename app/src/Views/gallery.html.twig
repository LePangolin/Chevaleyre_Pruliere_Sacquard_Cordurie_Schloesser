{% include "./parts/head.html.twig" %}
    
{% include "./parts/navbar.html.twig" %}

{% block body %}


{# Récupérer le titre de la galerie et l'afficher #}
    {% if gallery is defined %}
        <h1>{{gallery['name']}}</h1>
        <p>Description : {{gallery['description']}}</p>
        <p>Crée le : {{gallery['createdAt']}} par {{gallery['creator']}}</p>
        {% for tag in gallery['tags'] %}
            <p>{{tag}}</p>
        {% endfor %}
    {% else %}
        <h1>Pas d'information</h1>
    {% endif %}

    {% if is_author == true and pictures %}
            <input type="button" class="edit_button" onclick="self.location.href='/editGallery/{{gallery['id']}}'" value="Edit">      
            <input type="submit" id="delete_button" value="Delete">
            <input type="hidden" name="id_gallery" id="id_gallery" value={{gallery['id']}}>
        </form>
        <button class="add_image_button">Add Image</button>
        {% for picture in pictures %}
            <img class="clickable_picture" data-id="{{picture['id']}}" data-link="{{picture['link']}}" data-title="{{picture['title']}}" data-descr="{{picture['descr']}}" data-tags="{{picture['tags']}}" data-metadatas="{{picture['metadatas']}}" src="{{picture['link']}}" alt="{{picture['desc']}}">
        {% endfor %}
    {% elseif is_author == true and not pictures %}
        <input type="button" class="edit_button" onclick="self.location.href='/editGallery/{{gallery['id']}}'" value="Edit">
        <form id="delete_form" method="post" action="/deleteGallery">
            <input type="submit" id="delete_button" value="Delete">
            <input type="hidden" name="id_gallery" id="id_gallery" value={{gallery['id']}}>
        </form>
        <button class="add_image_middle_button">Add Image</button>
    {% elseif is_author == false and pictures %}
        {% for picture in pictures %}
            <img class="clickable_picture" data-id="{{picture['id']}}" data-link="{{picture['link']}}" data-descr="{{picture['descr']}}" data-tags="{{picture['tags']}}" data-metadatas="{{picture['metadatas']}}" src="{{picture['link']}}" alt="{{picture['desc']}}">
        {% endfor %}
    {% elseif is_author == false and not pictures %}
        <p>Pas d'image</p>        
    {% endif %}
    <div class="picture_info">
        <div class="modal-content">
            <span class="close">&times;</span>
            <div class="modal-content-div">
            </div>        
        </div>
    </div>
    <div class="addImage">
        <div class="modal-content">
            <span class="close">&times;</span>
            <form enctype='multipart/form-data' action="/gallery/{{gallery['id']}}" method="post">
                <input type='file' name='uploadImage' required><br><br>
                <input type="text" id="title" name="title" placeholder="Titre de l'image" required><br><br>
                <textarea id="descr" name="description" rows="5" cols="33" placeholder="Description de l'image" required></textarea><br>

                <h2 class="creationForm_tagsTitle">Mots-clés</h2>

                <div class="creationForm_tagInput">
                    <input class="tagInput_input" type="text" name="tag" placeholder="Ajouter un mot-clé">
                    <button type="button" class="tagInput_addButton"><span class="addButton_plusIcon material-symbols-outlined"> add </span></button>
                </div> 
                <div class="tagsDisplay">
                </div>

                <input class="creationForm_hiddenArray tagsArray" type="hidden" name="tags">

                <h2>Méta-données</h2>

                <div class="metadata">

                    <div class="flex-input">
                        <input type="text" class="name MD">
                        <input type="text" class="metadata MD">
                    </div>

                </div>

                <button id="confirmMetaData" type="button" class="confirmMetaData">Confirmer les méta-données</button>

                <input class="creationForm_hiddenArray metadataArray" type="hidden" name="metadataArray">

                <br>

                <input class="creationForm_submit" type="submit" name="confirm" value="Confirmer">
            </form>
        </div>
    </div>

    <footer>
        <script>
            {{source('./js/manageTags.js')}}
            {{source('./js/manageModal.js')}}
        </script>
    </footer>

{% endblock %}

{% include "./parts/footer.html.twig" %}